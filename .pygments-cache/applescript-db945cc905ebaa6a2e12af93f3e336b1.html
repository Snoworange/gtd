<div class="highlight"><pre><span class="c">-- Opens the currently selected Finder files, or else the current Finder window, in TextMate. Also handles dropped files and folders.</span>

<span class="c">-- By Henrik Nyh &lt;http://henrik.nyh.se&gt;</span>
<span class="c">-- Based loosely on http://snippets.dzone.com/posts/show/1037</span>

<span class="c">-- script was clicked</span>
<span class="k">on</span> <span class="nb">run</span>
  <span class="k">tell</span> <span class="nb">application</span> <span class="s2">&quot;Finder&quot;</span>
    <span class="k">if</span> <span class="nv">selection</span> <span class="ow">is</span> <span class="p">{}</span> <span class="k">then</span>
      <span class="k">set</span> <span class="nv">finderSelection</span> <span class="k">to</span> <span class="nv">folder</span> <span class="k">of</span> <span class="nb">the</span> <span class="nb">front</span> <span class="na">window</span> <span class="k">as </span><span class="nc">string</span>
    <span class="k">else</span>
      <span class="k">set</span> <span class="nv">finderSelection</span> <span class="k">to</span> <span class="nv">selection</span> <span class="k">as </span><span class="nc">alias </span><span class="nv">list</span>
    <span class="k">end</span> <span class="k">if</span>
  <span class="k">end</span> <span class="k">tell</span>

  <span class="nv">tm</span><span class="p">(</span><span class="nv">finderSelection</span><span class="p">)</span>
<span class="k">end</span> <span class="nb">run</span>

<span class="c">-- script was drag-and-dropped onto</span>
<span class="k">on</span> <span class="nb">open</span><span class="p">(</span><span class="nv">theList</span><span class="p">)</span>
  <span class="nv">tm</span><span class="p">(</span><span class="nv">theList</span><span class="p">)</span>
<span class="k">end</span> <span class="nb">open</span>

<span class="c">-- open in TextMate</span>
<span class="k">on</span> <span class="nv">tm</span><span class="p">(</span><span class="nv">listOfAliases</span><span class="p">)</span>
  <span class="k">tell</span> <span class="nb">application</span> <span class="s2">&quot;TextMate&quot;</span>
    <span class="nb">open</span> <span class="nv">listOfAliases</span>
    <span class="nb">activate</span>
  <span class="k">end</span> <span class="k">tell</span>
<span class="k">end</span> <span class="nv">tm</span>
</pre>
</div>
