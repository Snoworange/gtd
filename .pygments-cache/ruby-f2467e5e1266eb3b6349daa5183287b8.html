<div class="highlight"><pre><span class="c1"># By Henrik Nyh &lt;http://henrik.nyh.se&gt; 2007-06-15.</span>
<span class="c1"># Free to modify and redistribute with credit.</span>

<span class="c1"># Adds a find_all_by_solr method to acts_as_solr models to enable</span>
<span class="c1"># will_paginate for acts_as_solr search results.</span>

<span class="k">module</span> <span class="nn">ActsAsSolr</span>
  <span class="k">module</span> <span class="nn">PaginationExtension</span>

    <span class="k">def</span> <span class="nf">find_all_by_solr</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
      <span class="n">map</span> <span class="o">=</span> <span class="p">{</span><span class="ss">:limit</span> <span class="o">=&gt;</span> <span class="ss">:rows</span><span class="p">,</span> <span class="ss">:offset</span> <span class="o">=&gt;</span> <span class="ss">:start</span><span class="p">}</span>
      <span class="n">map</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">from</span><span class="p">,</span> <span class="n">to</span><span class="o">|</span>
        <span class="n">options</span><span class="o">[</span><span class="n">to</span><span class="o">]</span> <span class="o">=</span> <span class="n">options</span><span class="o">[</span><span class="n">from</span><span class="o">]</span>
        <span class="n">options</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">from</span><span class="p">)</span>
      <span class="k">end</span>
      <span class="n">find_by_solr</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
    <span class="k">end</span>

  <span class="k">end</span>
<span class="k">end</span>

<span class="k">module</span> <span class="nn">ActsAsSolr::ClassMethods</span>
  <span class="kp">include</span> <span class="no">ActsAsSolr</span><span class="o">::</span><span class="no">PaginationExtension</span>
<span class="k">end</span>
</pre>
</div>
