<div class="highlight"><pre><span class="k">set</span> <span class="nv">theTitle</span> <span class="k">to</span> <span class="s2">&quot;Currently playing&quot;</span>
<span class="k">set</span> <span class="nv">albumArt</span> <span class="k">to</span> <span class="nv">null</span>
<span class="k">set</span> <span class="nv">doMusic</span> <span class="k">to</span> <span class="no">false</span>

<span class="k">tell</span> <span class="nb">application</span> <span class="s2">&quot;iTunes&quot;</span>
  <span class="k">if</span> <span class="nv">player</span> <span class="na">state</span> <span class="ow">is</span> <span class="na">playing</span> <span class="k">then</span>
    <span class="k">set</span> <span class="nv">theArtist</span> <span class="k">to</span> <span class="nv">artist</span> <span class="k">of</span> <span class="nv">current</span> <span class="nv">track</span>
    <span class="k">set</span> <span class="nv">theSong</span> <span class="k">to</span> <span class="na">name</span> <span class="k">of</span> <span class="nv">current</span> <span class="nv">track</span>
    <span class="k">set</span> <span class="nv">theAlbum</span> <span class="k">to</span> <span class="nv">album</span> <span class="k">of</span> <span class="nv">current</span> <span class="nv">track</span>

    <span class="k">try</span>
      <span class="k">set</span> <span class="nv">albumArt</span> <span class="k">to</span> <span class="nb">data</span> <span class="k">of</span> <span class="nv">artwork</span> <span class="mi">1</span> <span class="k">of</span> <span class="nv">current</span> <span class="nv">track</span>
    <span class="nb">on</span> <span class="k">error</span>
      <span class="k">set</span> <span class="nv">albumArt</span> <span class="k">to</span> <span class="nv">null</span>
    <span class="k">end</span> <span class="k">try</span>

    <span class="k">set</span> <span class="nv">doMusic</span> <span class="k">to</span> <span class="no">true</span>
  <span class="k">end</span> <span class="k">if</span>
<span class="k">end</span> <span class="k">tell</span>

<span class="k">set</span> <span class="nv">appName</span> <span class="k">to</span> <span class="nv">theTitle</span>
<span class="k">set</span> <span class="nv">notification</span> <span class="k">to</span> <span class="nv">theTitle</span>
<span class="k">set</span> <span class="nv">myAllNotesList</span> <span class="k">to</span> <span class="p">{</span><span class="nv">notification</span><span class="p">}</span>

<span class="k">tell</span> <span class="nb">application</span> <span class="s2">&quot;System Events&quot;</span>
   <span class="k">set</span> <span class="nv">isRunning</span> <span class="k">to</span> <span class="p">(</span><span class="na">name</span> <span class="k">of</span> <span class="nv">processes</span><span class="p">)</span> <span class="ow">contains</span> <span class="s2">&quot;GrowlHelperApp&quot;</span>
<span class="k">end</span> <span class="k">tell</span>

<span class="k">if</span> <span class="nv">isRunning</span> <span class="k">then</span>
  <span class="k">tell</span> <span class="nb">application</span> <span class="s2">&quot;GrowlHelperApp&quot;</span>
    <span class="nb">register</span> <span class="k">as </span><span class="nc">application </span><span class="nv">appName</span>  <span class="nv">all</span> <span class="nv">notifications</span> <span class="nv">myAllNotesList</span>  <span class="nv">default</span> <span class="nv">notifications</span> <span class="nv">myAllNotesList</span>  <span class="nv">icon</span> <span class="k">of</span> <span class="nb">application</span> <span class="s2">&quot;iTunes&quot;</span>

    <span class="k">if</span> <span class="nv">doMusic</span>
      <span class="k">set</span> <span class="nv">theDesc</span> <span class="k">to</span> <span class="s2">&quot;Track:\t&quot;</span> <span class="o">&amp;</span> <span class="nv">theSong</span> <span class="o">&amp;</span> <span class="s2">&quot;\nAlbum:\t&quot;</span> <span class="o">&amp;</span> <span class="nv">theAlbum</span> <span class="o">&amp;</span> <span class="s2">&quot;\nArtist:\t&quot;</span> <span class="o">&amp;</span> <span class="nv">theArtist</span>
    <span class="k">else</span>
      <span class="k">set</span> <span class="nv">theDesc</span> <span class="k">to</span> <span class="s2">&quot;Nothing.&quot;</span>
    <span class="k">end</span>

    <span class="k">if</span> <span class="nv">albumArt</span> <span class="ow">is not</span> <span class="nv">null</span>
      <span class="nv">notify</span> <span class="nv">with</span>  <span class="na">name</span> <span class="nv">notification</span>  <span class="na">title</span> <span class="nv">theTitle</span>  <span class="nv">description</span> <span class="nv">theDesc</span>  <span class="nb">application</span> <span class="na">name</span> <span class="nv">appName</span>  <span class="nv">pictImage</span> <span class="nv">albumArt</span>
    <span class="k">else</span>
      <span class="nv">notify</span> <span class="nv">with</span>  <span class="na">name</span> <span class="nv">notification</span>  <span class="na">title</span> <span class="nv">theTitle</span>  <span class="nv">description</span> <span class="nv">theDesc</span>  <span class="nb">application</span> <span class="na">name</span> <span class="nv">appName</span>
    <span class="k">end</span> <span class="k">if</span>

  <span class="k">end</span> <span class="k">tell</span>
<span class="k">end</span> <span class="k">if</span>
</pre>
</div>
